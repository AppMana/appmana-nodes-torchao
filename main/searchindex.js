Search.setIndex({"docnames": ["api_ref_dtypes", "api_ref_intro", "api_ref_kernel", "api_ref_quantization", "api_ref_sparsity", "dtypes", "generated/torchao.dtypes.UInt4Tensor", "generated/torchao.dtypes.to_nf4", "generated/torchao.quantization.Int4WeightOnlyGPTQQuantizer", "generated/torchao.quantization.Int4WeightOnlyQuantizer", "generated/torchao.quantization.SmoothFakeDynQuantMixin", "generated/torchao.quantization.SmoothFakeDynamicallyQuantizedLinear", "generated/torchao.quantization.smooth_fq_linear_to_inference", "generated/torchao.quantization.swap_linear_with_smooth_fq_linear", "generated/torchao.sparsity.PerChannelNormObserver", "generated/torchao.sparsity.WandaSparsifier", "generated/torchao.sparsity.apply_fake_sparsity", "generated/torchao.sparsity.apply_sparse_semi_structured", "getting-started", "index", "overview", "performant_kernels", "quantization", "sg_execution_times", "sparsity", "tutorials/index", "tutorials/sg_execution_times", "tutorials/template_tutorial"], "filenames": ["api_ref_dtypes.rst", "api_ref_intro.rst", "api_ref_kernel.rst", "api_ref_quantization.rst", "api_ref_sparsity.rst", "dtypes.rst", "generated/torchao.dtypes.UInt4Tensor.rst", "generated/torchao.dtypes.to_nf4.rst", "generated/torchao.quantization.Int4WeightOnlyGPTQQuantizer.rst", "generated/torchao.quantization.Int4WeightOnlyQuantizer.rst", "generated/torchao.quantization.SmoothFakeDynQuantMixin.rst", "generated/torchao.quantization.SmoothFakeDynamicallyQuantizedLinear.rst", "generated/torchao.quantization.smooth_fq_linear_to_inference.rst", "generated/torchao.quantization.swap_linear_with_smooth_fq_linear.rst", "generated/torchao.sparsity.PerChannelNormObserver.rst", "generated/torchao.sparsity.WandaSparsifier.rst", "generated/torchao.sparsity.apply_fake_sparsity.rst", "generated/torchao.sparsity.apply_sparse_semi_structured.rst", "getting-started.rst", "index.rst", "overview.rst", "performant_kernels.rst", "quantization.rst", "sg_execution_times.rst", "sparsity.rst", "tutorials/index.rst", "tutorials/sg_execution_times.rst", "tutorials/template_tutorial.rst"], "titles": ["torchao.dtypes", "<code class=\"docutils literal notranslate\"><span class=\"pre\">torchao</span></code> API Reference", "torchao.kernel", "torchao.quantization", "torchao.sparsity", "Dtypes", "UInt4Tensor", "to_nf4", "Int4WeightOnlyGPTQQuantizer", "Int4WeightOnlyQuantizer", "SmoothFakeDynQuantMixin", "SmoothFakeDynamicallyQuantizedLinear", "smooth_fq_linear_to_inference", "swap_linear_with_smooth_fq_linear", "PerChannelNormObserver", "WandaSparsifier", "apply_fake_sparsity", "apply_sparse_semi_structured", "Getting Started", "Welcome to the torchao Documentation", "Overview", "Performant Kernels", "Quantization", "Computation times", "Sparsity", "&lt;no title&gt;", "Computation times", "Template Tutorial"], "terms": {"thi": [1, 6, 11, 14, 15, 16, 27], "section": 1, "introduc": 1, "dive": 1, "detail": 1, "how": 1, "integr": 1, "pytorch": [1, 19, 27], "optim": 1, "your": [1, 19], "machin": 1, "learn": [1, 27], "model": [1, 12, 13, 15, 16, 17, 19], "sparsiti": [1, 14, 15, 16, 17, 19], "quantiz": [1, 8, 9, 10, 11, 12, 13, 19], "dtype": [1, 6, 7, 19], "kernel": 1, "tba": [2, 5, 18, 20, 21, 22, 24], "class": [6, 8, 9, 10, 11, 14, 15], "torchao": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17], "elem": 6, "kwarg": [6, 10, 11, 14, 15, 17], "sourc": [6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 19, 25, 27], "tolist": 6, "list": [6, 13, 15], "number": [6, 15], "return": [6, 12, 13], "tensor": [6, 7, 15, 27], "nest": 6, "For": 6, "scalar": 6, "standard": 6, "python": [6, 25, 27], "just": 6, "like": 6, "item": [6, 27], "ar": [6, 15], "automat": [6, 27], "move": 6, "cpu": 6, "first": [6, 15], "necessari": 6, "oper": 6, "differenti": 6, "exampl": [6, 15, 23, 25, 26, 27], "torch": [6, 11, 12, 13, 16, 27], "randn": 6, "2": [6, 16, 27], "0": [6, 10, 11, 13, 15, 23, 26, 27], "012766935862600803": 6, "5415473580360413": 6, "08909505605697632": 6, "7729271650314331": 6, "block_siz": 7, "int": [7, 9, 15], "64": 7, "scaler_block_s": 7, "256": [7, 9], "blocksiz": 8, "percdamp": 8, "groupsiz": [8, 9], "inner_k_til": [8, 9], "8": [8, 9], "padding_allow": [8, 9], "true": [8, 9, 12], "devic": [8, 9], "type": [8, 9], "cuda": [8, 9], "bool": [9, 12], "option": [9, 12, 13, 15], "arg": [10, 11, 15], "set_debug_x_absmax": [10, 11], "set": [10, 11, 12, 15], "self": [10, 11], "x_running_abs_max": [10, 11], "valu": [10, 11, 12, 15], "which": [10, 11], "lead": [10, 11], "smooth": [10, 11], "scale": [10, 11, 12, 13], "all": [10, 11, 14, 15, 16, 23, 25], "ones": [10, 11, 15], "alpha": [10, 11, 13], "5": [10, 11, 13, 15, 27], "enabl": [10, 11], "perform": [10, 11, 12, 14], "benchmark": [10, 11, 12], "without": [10, 11], "calibr": [10, 11], "replac": [11, 13], "nn": [11, 12, 13], "linear": [11, 13, 16], "implement": 11, "dynam": 11, "per": [11, 15], "token": 11, "activ": [11, 12, 15], "channel": [11, 14], "weight": [11, 15], "base": [11, 15], "smoothquant": [11, 12, 13], "forward": [11, 14], "x": [11, 27], "defin": [11, 14, 15], "comput": [11, 14, 15], "everi": [11, 14], "call": [11, 14], "should": [11, 14, 15], "overridden": [11, 14], "subclass": [11, 14], "although": [11, 14], "recip": [11, 14], "pass": [11, 14], "need": [11, 14, 15], "within": [11, 14], "function": [11, 14, 15, 16, 19], "one": [11, 14], "modul": [11, 12, 13, 14, 15], "instanc": [11, 14], "afterward": [11, 14], "instead": [11, 14], "sinc": [11, 14], "former": [11, 14], "take": [11, 14], "care": [11, 14], "run": [11, 12, 14, 27], "regist": [11, 14], "hook": [11, 14], "while": [11, 14, 15], "latter": [11, 14], "silent": [11, 14], "ignor": [11, 14], "them": [11, 14], "classmethod": 11, "from_float": 11, "mod": 11, "convert": 11, "fake": 11, "version": 11, "note": [11, 15], "requir": 11, "to_infer": 11, "calcul": [11, 12], "prepar": [11, 12, 15], "infer": [11, 12], "debug_skip_calibr": 12, "fals": [12, 15], "none": [12, 13, 15], "each": [12, 14], "smoothfakedynamicallyquantizedlinear": [12, 13], "layer": [12, 13, 15, 16], "paramet": [12, 13, 15], "The": [12, 13, 15], "contain": [12, 13], "If": [12, 15], "maximum": 12, "debug": 12, "default": [12, 13], "skip_fqn_list": 13, "cur_fqn": 13, "equival": 13, "str": [13, 15], "fulli": 13, "qualifi": 13, "name": [13, 15], "skip": [13, 15], "dure": 13, "current": [13, 15], "being": 13, "process": [13, 27], "float": [13, 15], "factor": 13, "A": 14, "custom": 14, "observ": 14, "l2": 14, "norm": [14, 15], "store": 14, "buffer": 14, "x_orig": 14, "sparsity_level": 15, "semi_structured_block_s": 15, "wanda": 15, "sparsifi": 15, "prune": [15, 16, 19], "propos": 15, "http": 15, "arxiv": 15, "org": 15, "ab": 15, "2306": 15, "11695": 15, "an": [15, 19], "awar": 15, "method": 15, "remov": 15, "product": 15, "input": 15, "magnitud": 15, "control": 15, "three": 15, "variabl": 15, "1": [15, 23, 26, 27], "spars": 15, "block": 15, "zero": 15, "out": 15, "target": 15, "level": 15, "config": 15, "dict": 15, "ad": 15, "parametr": 15, "modifi": 15, "inplac": 15, "you": [15, 27], "preserv": 15, "origin": 15, "us": [15, 16, 19], "copi": 15, "deepcopi": 15, "squash_mask": 15, "params_to_keep": 15, "tupl": 15, "params_to_keep_per_lay": 15, "squash": 15, "mask": 15, "appropri": 15, "either": 15, "have": 15, "sparse_param": 15, "attach": 15, "kei": [15, 27], "save": 15, "repres": 15, "specifi": 15, "param": 15, "specif": 15, "fqn": 15, "string": 15, "xdoctest": 15, "local": 15, "undefin": 15, "don": 15, "t": 15, "ani": 15, "hasattr": 15, "submodule1": 15, "keep": 15, "linear1": 15, "foo": 15, "bar": 15, "submodule2": 15, "linear42": 15, "baz": 15, "print": [15, 27], "42": 15, "24": 15, "some": 15, "other": [15, 27], "update_mask": 15, "tensor_nam": 15, "statist": 15, "retriev": 15, "act_per_input": 15, "Then": 15, "metric": 15, "matrix": 15, "compar": 15, "across": 15, "whole": 15, "simul": 16, "4": 16, "It": 16, "ao": 16, "flow": 16, "open": 19, "librari": 19, "provid": 19, "nativ": 19, "our": 19, "under": 19, "develop": 19, "more": 19, "content": 19, "come": 19, "soon": 19, "00": [23, 26], "003": [23, 26, 27], "total": [23, 26, 27], "execut": [23, 26], "file": [23, 26], "from": [23, 26, 27], "galleri": [23, 25, 27], "mem": [23, 26], "mb": [23, 26], "templat": [23, 25, 26], "tutori": [23, 25, 26], "tutorials_sourc": 23, "template_tutori": [23, 26, 27], "py": [23, 26, 27], "download": [25, 27], "code": [25, 27], "tutorials_python": 25, "zip": 25, "jupyt": [25, 27], "notebook": [25, 27], "tutorials_jupyt": 25, "gener": [25, 27], "sphinx": [25, 27], "go": 27, "end": 27, "full": 27, "author": 27, "firstnam": 27, "lastnam": 27, "what": 27, "3": 27, "prerequisit": 27, "v2": 27, "gpu": 27, "describ": 27, "why": 27, "topic": 27, "import": 27, "add": 27, "link": 27, "relev": 27, "research": 27, "paper": 27, "walk": 27, "through": 27, "output": 27, "below": 27, "rand": 27, "1719": 27, "7366": 27, "8125": 27, "1143": 27, "8106": 27, "0288": 27, "1260": 27, "4647": 27, "3800": 27, "7394": 27, "1135": 27, "0654": 27, "5378": 27, "2342": 27, "8473": 27, "practic": 27, "user": 27, "test": 27, "knowledg": 27, "nlp": 27, "scratch": 27, "summar": 27, "concept": 27, "cover": 27, "highlight": 27, "takeawai": 27, "link1": 27, "link2": 27, "time": 27, "script": 27, "minut": 27, "second": 27, "ipynb": 27}, "objects": {"torchao.dtypes": [[6, 0, 1, "", "UInt4Tensor"], [7, 2, 1, "", "to_nf4"]], "torchao.dtypes.UInt4Tensor": [[6, 1, 1, "", "tolist"]], "torchao.quantization": [[8, 0, 1, "", "Int4WeightOnlyGPTQQuantizer"], [9, 0, 1, "", "Int4WeightOnlyQuantizer"], [10, 0, 1, "", "SmoothFakeDynQuantMixin"], [11, 0, 1, "", "SmoothFakeDynamicallyQuantizedLinear"], [12, 2, 1, "", "smooth_fq_linear_to_inference"], [13, 2, 1, "", "swap_linear_with_smooth_fq_linear"]], "torchao.quantization.SmoothFakeDynQuantMixin": [[10, 1, 1, "", "set_debug_x_absmax"]], "torchao.quantization.SmoothFakeDynamicallyQuantizedLinear": [[11, 1, 1, "", "forward"], [11, 1, 1, "", "from_float"], [11, 1, 1, "", "set_debug_x_absmax"], [11, 1, 1, "", "to_inference"]], "torchao": [[4, 3, 0, "-", "sparsity"]], "torchao.sparsity": [[14, 0, 1, "", "PerChannelNormObserver"], [15, 0, 1, "", "WandaSparsifier"], [16, 2, 1, "", "apply_fake_sparsity"], [17, 2, 1, "", "apply_sparse_semi_structured"]], "torchao.sparsity.PerChannelNormObserver": [[14, 1, 1, "", "forward"]], "torchao.sparsity.WandaSparsifier": [[15, 1, 1, "", "prepare"], [15, 1, 1, "", "squash_mask"], [15, 1, 1, "", "update_mask"]]}, "objtypes": {"0": "py:class", "1": "py:method", "2": "py:function", "3": "py:module"}, "objnames": {"0": ["py", "class", "Python class"], "1": ["py", "method", "Python method"], "2": ["py", "function", "Python function"], "3": ["py", "module", "Python module"]}, "titleterms": {"torchao": [0, 1, 2, 3, 4, 19], "dtype": [0, 5], "api": [1, 19], "refer": [1, 19], "python": 1, "kernel": [2, 21], "quantiz": [3, 22], "sparsiti": [4, 24], "uint4tensor": 6, "to_nf4": 7, "int4weightonlygptqquant": 8, "int4weightonlyquant": 9, "smoothfakedynquantmixin": 10, "smoothfakedynamicallyquantizedlinear": 11, "smooth_fq_linear_to_infer": 12, "swap_linear_with_smooth_fq_linear": 13, "perchannelnormobserv": 14, "wandasparsifi": 15, "apply_fake_spars": 16, "apply_sparse_semi_structur": 17, "get": 18, "start": 18, "welcom": 19, "document": 19, "overview": [20, 27], "perform": 21, "comput": [23, 26], "time": [23, 26], "templat": 27, "tutori": 27, "step": 27, "option": 27, "addit": 27, "exercis": 27, "conclus": 27, "further": 27, "read": 27}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx.ext.todo": 2, "sphinx.ext.viewcode": 1, "sphinx": 56}})